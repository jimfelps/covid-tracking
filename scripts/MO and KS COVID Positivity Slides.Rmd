---
title: "COVID-19 Positive Rates in Missouri, Kansas, and Selected States"
author: "Jim Felps"
date: "6/14/2020"
output:
  powerpoint_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```


```{r}
source('./scripts/Daily State Data.R')
source('./scripts/KC Metro Counties - Covdata.R')
source('./scripts/MO Counties - Covdata.R')

```

## Missouri

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "MO",
         date > "2020-03-27") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity") +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        ) 

ggsave("images/missouri.png")
```

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "MO",
         date >= "2020-06-01") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity") +
    labs(
      x = "",
      y = "",
      title = "Missouri Positivity Rate since June 1, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        ) 

ggsave("images/missouri_june.png")
```


## Kansas

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "KS",
         date > "2020-03-19") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity")  +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        )

ggsave("images/ks.png")
```

# County-level analysis - KC Metro

## New Positive Cases by County
```{r fig.height=8, fig.width=12}
metro_kc %>% 
  ggplot(aes(date, new_pos_7dma, group = county, color = county)) +
  geom_line(size = 1) +
  scale_color_viridis(discrete = TRUE) +
  labs(
    x = "",
    y = "",
    caption = "Data from NYT Covid repository \nhttps://github.com/nytimes/covid-19-data"
  )

ggsave("images/metro_counties.png")
```

## All MO Counties

```{r fig.height=8, fig.width=12}
mo_counties_7ma %>% 
  ggplot(aes(date, new_pos_7dma, group = county)) +
  geom_line(size = 1, col = "darkred") +
  labs(
    x = "",
    y = "",
    caption = "Data from NYT Covid repository \nhttps://github.com/nytimes/covid-19-data"
      ) +
  gghighlight(county %in% select_counties,
              unhighlighted_colour = alpha("steelblue", 0.4),
              label_key = county,
              label_params = list(size = 3))

ggsave("images/mo_counties.png")
```

# Select States with Problematic Trends \n(based on media coverage)

## Arizona

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "AZ",
         date > "2020-03-26") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity")  +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        )

ggsave("images/az.png")
```

## OK

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "OK",
         date > "2020-04-10") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity")  +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        )

ggsave("images/ok.png")
```

## Alabama

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "AL",
         date > "2020-03-21") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity")  +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        )

ggsave("images/al.png")
```

## Florida

```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "FL",
         date > "2020-03-21") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity")  +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        )

ggsave("images/fl.png")
```

## New York


```{r fig.height=8, fig.width=12}
state_data %>%
  filter(state == "NY",
         date > "2020-03-12") %>%
  ggplot(aes(date, pos_rate_7dma)) +
    geom_line(stat = "identity")  +
    labs(
      x = "",
      y = "",
      title = "COVID Testing Positivity, 7 Day Moving Average",
      subtitle = "",
      caption = "Data from COVID Tracking project\nhttps://covidtracking.com/"
        )

ggsave("images/ny.png")
```

